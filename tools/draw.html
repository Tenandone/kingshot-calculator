<!doctype html>
<html lang="ko">
<head>
  <base href="/" />
<script src="/js/standalone-bridge.js?v=202509120604" defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kingshot ëŒ“ê¸€ ì´ë²¤íŠ¸ ì¶”ì²¨ê¸°</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,sans-serif;background:#fff;margin:0;color:#111}
    header{background:#f7f7f8;border-bottom:1px solid #ddd;padding:12px}
    h1{margin:0;font-size:18px}
    main{padding:20px;max-width:900px;margin:auto}
    section{background:#fafafa;border:1px solid #eee;border-radius:12px;padding:16px;margin-bottom:16px}
    h2{font-size:16px;margin-top:0}
    textarea,input{width:100%;box-sizing:border-box;border:1px solid #ccc;border-radius:8px;padding:8px;margin:4px 0;font-size:14px}
    .btn{padding:8px 12px;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer;margin-right:6px}
    .btn.primary{background:#0b57d0;color:#fff;border:none}
    .winner-list{border:1px dashed #aaa;border-radius:8px;padding:10px;margin:6px 0}

    /* â–¼ ì°¸ê°€ì ê·¸ë¦¬ë“œ(ê°€ë¡œ ë‚˜ì—´) */
    .list-wrap{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px;margin-top:8px}
    .chip{display:inline-block;padding:6px 10px;border:1px solid #ddd;border-radius:999px;background:#fff;
          font-size:13px;line-height:1.1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .muted{color:#666;font-size:13px}
    #list{min-height:140px} /* ì…ë ¥ì°½ì€ ì¡°ê¸ˆë§Œ ë³´ì´ê²Œ */
  </style>
</head>
<body>
  <header>
    <h1>Kingshot ëŒ“ê¸€ ì´ë²¤íŠ¸ ì¶”ì²¨ê¸°</h1>
  </header>
  <main>
    <section>
      <h2>â‘  ì›ë¬¸ ë¶™ì—¬ë„£ê¸°</h2>
      <textarea id="raw" placeholder="ë„¤ì´ë²„ ì¹´í˜ ëŒ“ê¸€ ì›ë¬¸ ì „ì²´ ë³µì‚¬ í›„ ë¶™ì—¬ë„£ê¸°"></textarea>
      <button class="btn" id="btnParse">ì°¸ê°€ì ì¶”ì¶œ</button>
      <button class="btn" id="btnClear">ì§€ìš°ê¸°</button>
    </section>

    <section>
      <h2>â‘¡ ê²½í’ˆ ì„¤ì •</h2>
      <label>ğŸ¥‡ 1ë“± ê²½í’ˆëª… <input id="prize1Label" type="text" value="ë¡¯ë°ë¦¬ì•„ í•œìš° ë¶ˆê³ ê¸°ë²„ê±° ì„¸íŠ¸"></label>
      <label>1ë“± ì¸ì›ìˆ˜ <input id="prize1Count" type="number" value="1"></label>
      <label>ğŸ¥ˆ 2ë“± ê²½í’ˆëª… <input id="prize2Label" type="text" value="êµ¬ê¸€ ê¸°í”„íŠ¸ì¹´ë“œ (1ë§Œì›)"></label>
      <label>2ë“± ì¸ì›ìˆ˜ <input id="prize2Count" type="number" value="1"></label>
      <label>ğŸ¥‰ 3ë“± ê²½í’ˆëª… <input id="prize3Label" type="text" value="ì»¤í”¼ ê¸°í”„í‹°ì½˜"></label>
      <label>3ë“± ì¸ì›ìˆ˜ <input id="prize3Count" type="number" value="20"></label>
    </section>

    <section>
      <h2>â‘¢ ì°¸ê°€ì ëª©ë¡</h2>
      <!-- ë°ì´í„° í¸ì§‘ìš©(ìœ ì§€) -->
      <textarea id="list" placeholder="ë‹‰ë„¤ì„ì„ ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„(ìë™ìœ¼ë¡œ ì˜¤ë¥¸ìª½ ê·¸ë¦¬ë“œì— í‘œì‹œë©ë‹ˆë‹¤)"></textarea>
      <div class="muted">í˜„ì¬ ì°¸ê°€ì: <span id="count">0</span>ëª…</div>

      <!-- ê°€ë¡œ ë‚˜ì—´ ë¯¸ë¦¬ë³´ê¸° -->
      <div id="listView" class="list-wrap" aria-live="polite"></div>
    </section>

    <section>
      <h2>â‘£ ì¶”ì²¨</h2>
      <button class="btn primary" id="btnDraw">ì¶”ì²¨í•˜ê¸°</button>
      <div id="results">
        <div id="wPrize1" class="winner-list" hidden></div>
        <div id="wPrize2" class="winner-list" hidden></div>
        <div id="wPrize3" class="winner-list" hidden></div>
      </div>
    </section>
  </main>

  <script>
    const raw = document.getElementById('raw');
    const list = document.getElementById('list');
    const listView = document.getElementById('listView');
    const countEl = document.getElementById('count');

    // ê³µìš©: í˜„ì¬ í…ìŠ¤íŠ¸ ì˜ì—­ì„ ë°°ì—´ë¡œ ë³€í™˜
    function getNames(){
      return list.value.split(/\n/).map(s=>s.trim()).filter(Boolean);
    }

    function updateCount(){
      countEl.textContent = getNames().length;
    }

    // ì°¸ê°€ì ì¹© ê·¸ë¦¬ë“œ ë Œë”ë§
    function renderListView(){
      const names = getNames();
      if (!names.length){ listView.innerHTML = '<span class="muted">ì•„ì§ ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤.</span>'; return; }
      listView.innerHTML = names.map(n=>`<span class="chip" title="${n}">${n}</span>`).join('');
    }

    document.getElementById('btnParse').addEventListener('click', ()=>{
      const lines = raw.value.split(/\n/).map(s=>s.trim());
      const names = [];
      let expectName = false;
      for (const line of lines){
        if (!line) continue;
        if (line === 'í”„ë¡œí•„ ì‚¬ì§„'){ expectName = true; continue; }
        if (expectName){ names.push(line); expectName=false; continue; }
      }
      list.value = names.join('\n');   // í¸ì§‘ìš© ì €ì¥
      updateCount();
      renderListView();                // ê·¸ë¦¬ë“œ ì¦‰ì‹œ ë°˜ì˜
    });

    document.getElementById('btnClear').addEventListener('click', ()=>{
      raw.value=''; list.value='';
      updateCount();
      renderListView();
    });

    document.getElementById('btnDraw').addEventListener('click', ()=>{
      const names = getNames();
      if (!names.length){ alert('ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }
      const shuffled = [...names].sort(()=>Math.random()-0.5);

      const p1Label = document.getElementById('prize1Label').value;
      const p1Count = parseInt(document.getElementById('prize1Count').value)||0;
      const p2Label = document.getElementById('prize2Label').value;
      const p2Count = parseInt(document.getElementById('prize2Count').value)||0;
      const p3Label = document.getElementById('prize3Label').value;
      const p3Count = parseInt(document.getElementById('prize3Count').value)||0;

      const p1 = shuffled.slice(0,p1Count);
      const p2 = shuffled.slice(p1Count,p1Count+p2Count);
      const p3 = shuffled.slice(p1Count+p2Count,p1Count+p2Count+p3Count);

      function render(el,label,list){
        if(list.length){
          el.hidden=false;
          el.innerHTML = `<b>${label}</b><br>`+list.join(', ');
        } else { el.hidden=true; }
      }
      render(document.getElementById('wPrize1'),'ğŸ¥‡ '+p1Label,p1);
      render(document.getElementById('wPrize2'),'ğŸ¥ˆ '+p2Label,p2);
      render(document.getElementById('wPrize3'),'ğŸ¥‰ '+p3Label,p3);
    });

    // ì…ë ¥ì°½ì´ ë°”ë€Œì–´ë„ ì¦‰ì‹œ ì¹© ì—…ë°ì´íŠ¸
    list.addEventListener('input', ()=>{ updateCount(); renderListView(); });

    // ì´ˆê¸° í‘œì‹œ
    updateCount();
    renderListView();
  </script>
</body>
</html>
