<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kingshot Truegold / Refined Truegold Chart</title>
  <style>
    :root{
      --bd:#e6e8ef;
      --bd2:#eef0f6;
      --bg:#ffffff;
      --bg2:#f7f8fb;
      --tx:#14161a;
      --mut:#6b7280;
      --shadow: 0 10px 24px rgba(0,0,0,.05);
      --radius: 16px;
    }
    body{
      margin:0;
      background:#fafbff;
      color:var(--tx);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .wrap{
      max-width: 1200px;
      margin: 22px auto 40px;
      padding: 0 16px;
    }

    /* ========= section ========= */
    .section{
      margin-top: 18px;
      border:1px solid var(--bd);
      background: var(--bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .section-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 14px 14px;
      background: var(--bg2);
      border-bottom:1px solid var(--bd);
    }
    .section-head .left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid var(--bd);
      background:#fff;
      font-weight: 800;
      font-size: 12px;
      color:#111827;
      white-space:nowrap;
    }
    .hint{
      font-size: 12px;
      color: var(--mut);
      line-height: 1.35;
    }

    /* ========= grid cards ========= */
    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
      padding: 14px;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (max-width: 620px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border:1px solid var(--bd);
      border-radius: 14px;
      background:#fff;
      overflow:hidden;
    }
    .card-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 10px 10px;
      background:#fbfcff;
      border-bottom:1px solid var(--bd2);
    }
    .binfo{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }
    .bicon{
      width:46px;height:46px;
      object-fit:contain;
      background:#f2f3f7;
      border-radius: 12px;
      padding:6px;
      flex: 0 0 auto;
    }
    .bname{
      font-weight: 900;
      font-size: 13px;
      color:#111827;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* ========= table ========= */
    table{
      width:100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    thead th{
      background:#ffffff;
      border-bottom:1px solid var(--bd2);
      padding: 8px 6px;
      text-align:center;
      font-size: 12px explained;
    }
    tbody td{
      border-bottom:1px solid #f1f3f8;
      padding: 8px 6px;
      text-align:center;
      vertical-align: middle;
    }
    tbody tr:last-child td{ border-bottom:0; }

    .ico-mini{
      width:20px;height:20px;
      object-fit:contain;
      vertical-align:middle;
      opacity:.95;
    }

    .num{
      font-variant-numeric: tabular-nums;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .muted{
      color: var(--mut);
      font-weight: 800;
    }

    /* ========= level badge ========= */
    .lvl{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .lvl-img{
      width:34px;height:34px;
      object-fit:contain;
    }
    .lvl-fallback{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:34px;height:34px;
      border-radius: 10px;
      background:#eef2ff;
      border:1px solid #dbeafe;
      font-weight: 1000;
      font-size: 12px;
      color:#1f2937;
    }

    /* ========= a11y ========= */
    .sr-only{
      position:absolute;
      width:1px;height:1px;
      padding:0;margin:-1px;
      overflow:hidden;clip:rect(0,0,0,0);
      white-space:nowrap;border:0;
    }

    /* ========= tiny footer note ========= */
    .note{
      padding: 12px 14px 14px;
      border-top:1px solid var(--bd2);
      color: var(--mut);
      font-size: 12px;
      line-height: 1.5;
      background:#fff;
    }
    .note .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .note .row span{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding: 4px 8px;
      border:1px solid var(--bd);
      border-radius: 999px;
      background:#fbfcff;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- =========================
         SECTION 1: Lv.1~5 (엑셀 값 반영 완료)
         ========================= -->
    <section class="section" aria-label="Base levels (Lv 1–5)">
      <div class="section-head">
        <div class="left">
          <div class="pill">
            <img class="ico-mini" src="/img/icons/level.webp" alt="Level" />
            <span class="sr-only">Levels</span>
            <span>Lv 1–5</span>
          </div>
          <div class="hint">
            (Language-free) icons + numbers only
          </div>
        </div>
      </div>

      <div class="grid" id="grid-basic"></div>

      <div class="note">
        <div class="row">
          <span><img class="ico-mini" src="/img/icons/truegold.webp" alt="Truegold"> Truegold</span>
          <span><img class="ico-mini" src="/img/icons/refined-truegold.webp" alt="Refined Truegold"> Refined</span>
          <span><img class="ico-mini" src="/img/icons/total.webp" alt="Total"> Total</span>
        </div>
      </div>
    </section>

    <!-- =========================
         SECTION 2: TG 1~8 (빈칸 자리 준비)
         ========================= -->
    <section class="section" aria-label="TG levels (TG 1–8)">
      <div class="section-head">
        <div class="left">
          <div class="pill">
            <img class="ico-mini" src="/img/icons/tg.webp" alt="TG" />
            <span class="sr-only">TG levels</span>
            <span>TG 1–8</span>
          </div>
          <div class="hint">
            TG/정련순금 값은 여기 데이터만 채우면 자동으로 표가 완성됨
          </div>
        </div>
      </div>

      <div class="grid" id="grid-tg"></div>

      <div class="note">
        TG 뱃지 이미지 경로 예시:
        <code>/img/badges/tg1.webp</code> … <code>/img/badges/tg8.webp</code>
      </div>
    </section>

  </div>

  <script>
    /* =========================
       0) 이미지 경로/메타 (여기만 네 프로젝트에 맞게 수정)
       ========================= */
    const ICONS = {
      level: '/img/icons/level.webp',
      tg: '/img/icons/tg.webp',
      truegold: '/img/icons/truegold.webp',
      refined: '/img/icons/refined-truegold.webp',
      total: '/img/icons/total.webp'
    };

    // // 왜: 언어-초월형이지만, 관리자(너)는 관리해야 하니까 buildingKey를 기준으로 아이콘/표시명만 매핑
    const BUILDINGS = {
      towncenter:    { name: 'Town Center',    icon: '/img/buildings/towncenter-kingshot.webp' },
      barracks:      { name: 'Barracks',       icon: '/img/buildings/barracks-kingshot.webp' },
      embassy:       { name: 'Embassy',        icon: '/img/buildings/embassy-kingshot.webp' },
      waracademy:    { name: 'War Academy',    icon: '/img/buildings/waracademy.webp' },
      commandcenter: { name: 'Command Center', icon: '/img/buildings/commandcenter.webp' },
      infirmary:     { name: 'Infirmary',      icon: '/img/buildings/infirmary-kingshot.webp' }
    };

    // 레벨 뱃지 (이미지 없으면 자동으로 숫자 박스로 fallback)
    function lvBadgeSrc(lv){ return `/img/badges/lv${lv}.webp`; }
    function tgBadgeSrc(tg){ return `/img/badges/tg${tg}.webp`; }

    /* =========================
       1) 엑셀(순금간이표.xlsx)에서 읽어온 "Lv1~5" 실제 데이터
       - 정련순금(refined)은 추후 네가 채우면 됨 (현재 0)
       ========================= */
    const BASIC_DATA = [
      {
        "buildingKey": "towncenter",
        "levels": [
          { "level": 1, "truegold": 132, "refined": 0, "total": 660 },
          { "level": 2, "truegold": 158, "refined": 0, "total": 790 },
          { "level": 3, "truegold": 238, "refined": 0, "total": 1190 },
          { "level": 4, "truegold": 280, "refined": 0, "total": 1400 },
          { "level": 5, "truegold": 335, "refined": 0, "total": 1675 }
        ]
      },
      {
        "buildingKey": "barracks",
        "levels": [
          { "level": 1, "truegold": 59, "refined": 0, "total": 295 },
          { "level": 2, "truegold": 71, "refined": 0, "total": 355 },
          { "level": 3, "truegold": 107, "refined": 0, "total": 535 },
          { "level": 4, "truegold": 126, "refined": 0, "total": 630 },
          { "level": 5, "truegold": 150, "refined": 0, "total": 750 }
        ]
      },
      {
        "buildingKey": "embassy",
        "levels": [
          { "level": 1, "truegold": 33, "refined": 0, "total": 165 },
          { "level": 2, "truegold": 39, "refined": 0, "total": 195 },
          { "level": 3, "truegold": 59, "refined": 0, "total": 295 },
          { "level": 4, "truegold": 70, "refined": 0, "total": 350 },
          { "level": 5, "truegold": 83, "refined": 0, "total": 415 }
        ]
      },
      {
        "buildingKey": "waracademy",
        "levels": [
          { "level": 1, "truegold": null, "refined": 0, "total": null },
          { "level": 2, "truegold": 71, "refined": 0, "total": 355 },
          { "level": 3, "truegold": 107, "refined": 0, "total": 535 },
          { "level": 4, "truegold": 126, "refined": 0, "total": 630 },
          { "level": 5, "truegold": 150, "refined": 0, "total": 750 }
        ]
      },
      {
        "buildingKey": "commandcenter",
        "levels": [
          { "level": 1, "truegold": 26, "refined": 0, "total": 130 },
          { "level": 2, "truegold": 31, "refined": 0, "total": 155 },
          { "level": 3, "truegold": 47, "refined": 0, "total": 235 },
          { "level": 4, "truegold": 56, "refined": 0, "total": 280 },
          { "level": 5, "truegold": 67, "refined": 0, "total": 335 }
        ]
      },
      {
        "buildingKey": "infirmary",
        "levels": [
          { "level": 1, "truegold": 26, "refined": 0, "total": 130 },
          { "level": 2, "truegold": 31, "refined": 0, "total": 155 },
          { "level": 3, "truegold": 47, "refined": 0, "total": 235 },
          { "level": 4, "truegold": 56, "refined": 0, "total": 280 },
          { "level": 5, "truegold": 67, "refined": 0, "total": 335 }
        ]
      }
    ];

    /* =========================
       2) TG1~8 데이터 (현재 자리만 준비 / 네가 나중에 값 채우면 자동 렌더)
       - truegold / refined / total 넣으면 끝
       ========================= */
    const TG_DATA = Object.keys(BUILDINGS).map((buildingKey) => ({
      buildingKey,
      levels: Array.from({ length: 8 }, (_, i) => ({
        tg: i + 1,
        truegold: null,
        refined: null,
        total: null
      }))
    }));

    /* =========================
       3) 렌더 유틸
       ========================= */
    function fmt(v){
      if (v === null || v === undefined) return '—';
      const n = Number(v);
      if (!Number.isFinite(n)) return '—';
      return n.toLocaleString('en-US');
    }

    function calcTotal(row){
      // // 왜: total이 비어있으면 truegold+refined로 자동 계산해주면 입력이 편함
      if (row.total !== null && row.total !== undefined) return row.total;
      const tg = Number(row.truegold || 0);
      const rf = Number(row.refined || 0);
      const sum = tg + rf;
      return sum > 0 ? sum : null;
    }

    function levelCellHTML({ kind, value }){
      // kind: 'lv' | 'tg'
      const src = kind === 'tg' ? tgBadgeSrc(value) : lvBadgeSrc(value);
      const label = kind === 'tg' ? `TG ${value}` : `Lv ${value}`;

      // // 왜: 이미지가 없을 수도 있으니 onerror로 fallback 박스를 보여주게 함
      return `
        <div class="lvl">
          <img class="lvl-img" src="${src}" alt="${label}"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-flex';" />
          <span class="lvl-fallback" style="display:none">${kind === 'tg' ? ('TG' + value) : value}</span>
        </div>
      `;
    }

    function cardHTML(item, mode){
      const meta = BUILDINGS[item.buildingKey] || { name: item.buildingKey, icon: '' };
      const headName = meta.name; // 화면에 보여도 됨(영어 기준). 완전 숨기고 싶으면 sr-only 처리해도 됨.

      const rows = item.levels.map((r) => {
        const isTG = mode === 'tg';
        const badge = levelCellHTML({ kind: isTG ? 'tg' : 'lv', value: isTG ? r.tg : r.level });

        const total = calcTotal(r);

        return `
          <tr>
            <td>${badge}</td>
            <td class="num">${fmt(r.truegold)}</td>
            <td class="num">${fmt(r.refined)}</td>
            <td class="num">${fmt(total)}</td>
          </tr>
        `;
      }).join('');

      return `
        <div class="card" data-building="${item.buildingKey}">
          <div class="card-head">
            <div class="binfo">
              <img class="bicon" src="${meta.icon}" alt="${meta.name}" loading="lazy">
              <div class="bname">${headName}</div>
            </div>
          </div>

          <table aria-label="${meta.name} table">
            <thead>
              <tr>
                <th><img class="ico-mini" src="${mode === 'tg' ? ICONS.tg : ICONS.level}" alt="Level"></th>
                <th><img class="ico-mini" src="${ICONS.truegold}" alt="Truegold"></th>
                <th><img class="ico-mini" src="${ICONS.refined}" alt="Refined"></th>
                <th><img class="ico-mini" src="${ICONS.total}" alt="Total"></th>
              </tr>
            </thead>
            <tbody>
              ${rows}
            </tbody>
          </table>
        </div>
      `;
    }

    function render(){
      const basicRoot = document.getElementById('grid-basic');
      const tgRoot = document.getElementById('grid-tg');

      basicRoot.innerHTML = BASIC_DATA.map((x) => cardHTML(x, 'lv')).join('');
      tgRoot.innerHTML = TG_DATA.map((x) => cardHTML(x, 'tg')).join('');
    }

    render();
  </script>
</body>
</html>
